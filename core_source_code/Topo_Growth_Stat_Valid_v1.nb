Notebook[{Cell[
CellGroupData[{Cell[
BoxData[{StyleBox[RowBox[{RowBox[{"(*"," ",RowBox[
{RowBox[{"===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","==="}],"="}]," ","*)"}],"\n",RowBox[
{"(*"," ",RowBox[{"TCCT"," ","\:6f14\:5316\:4e0e\:8d39\:7c73\:7edf\:8ba1\:9a8c\:8bc1"," ",RowBox[
{"(","\:5168\:517c\:5bb9\:4fee\:590d\:7248",")"}]}]," ","*)"}],"\n",RowBox[{"(*"," ",RowBox[
{RowBox[{"===","===","===","===","===","===","===","===","===","===","===","===","===","===","===","==="}],"="}]," ","*)"}],"\n","\n",RowBox[
{RowBox[{"ClearAll","[","\"Global`*\"","]"}],";"}]}]],"\n",RowBox[{RowBox[{"SeedRandom","[","1234","]"}],";"}],RowBox[
{"\n","\n"}],StyleBox[RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{RowBox[{"--",RowBox[
{"-"," ","1."}]}]," ","\:5b9a\:4e49\:6838\:5fc3\:51fd\:6570"," ",RowBox[{RowBox[{"(","StepEvolution",")"}]," ","--"}]}],"-"}]," ","*)"}],"\n",RowBox[
{RowBox[{RowBox[{"StepEvolution","[","g_Graph","]"}]," ",":="," ",RowBox[{"Module","[",RowBox[
{RowBox[{"{","\n","   ",RowBox[{"allEdges",","," ","activeEdges",","," ","candidates",","," ","\n","   ","e1",","," ","e2",","," ","x",","," ","y",","," ","z",","," ","w",","," ","\n","   ","newActive",","," ","inertEdges",","," ","remainingEdges",","," ","\n","   ","pairFound",","," ","shuffled",","," ","nActive"}],"\n","  ","}"}],",","\n","  ","\n","  ",RowBox[
{RowBox[{"allEdges"," ","="," ",RowBox[{"EdgeList","[","g","]"}]}],";","\n","  ",RowBox[
{"activeEdges"," ","="," ",RowBox[{"Cases","[",RowBox[{"allEdges",","," ","_UndirectedEdge"}],"]"}]}],";","\n","  ",RowBox[
{"nActive"," ","="," ",RowBox[{"Length","[","activeEdges","]"}]}],";","\n","  ","\n","  ",RowBox[
{"If","[",RowBox[{RowBox[{"nActive"," ","<"," ","2"}],","," ",RowBox[{"Return","[","g","]"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"shuffled"," ","="," ",RowBox[{"RandomSample","[","activeEdges","]"}]}],";","\n","  ",RowBox[
{"pairFound"," ","="," ","False"}],";","\n","  ","\n","  ",RowBox[{"(*"," ","\:5bfb\:627e\:53cd\:5e94\:5bf9"," ","*)"}],"\n","  ",RowBox[
{"Do","[","\n","     ",RowBox[{RowBox[{RowBox[{"e1"," ","="," ",RowBox[{"shuffled","[",RowBox[
{"[","i","]"}],"]"}]}],";","\n","     ",RowBox[{"Do","[","\n","        ",RowBox[{RowBox[
{RowBox[{"e2"," ","="," ",RowBox[{"shuffled","[",RowBox[{"[","j","]"}],"]"}]}],";","\n","        ",RowBox[
{"(*"," ",RowBox[{"\:4e25\:683c\:5224\:5b9a","\:ff1a","\:5171\:4eab\:6070\:597d1\:4e2a\:9876\:70b9"}]," ","*)"}],"\n","        ",RowBox[
{"If","[",RowBox[{RowBox[{RowBox[{"Length","[",RowBox[{"Intersection","[",RowBox[
{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[{"List"," ","@@"," ","e2"}]}],"]"}],"]"}]," ","=="," ","1"}],",","\n","           ",RowBox[
{RowBox[{"pairFound"," ","="," ","True"}],";","\n","           ",RowBox[{"Break","[","]"}],";"}]}]," ","\n","        ","]"}],";"}],"\n","     ",","," ",RowBox[
{"{",RowBox[{"j",","," ",RowBox[{"i"," ","+"," ","1"}],","," ","nActive"}],"}"}]}],"]"}],";","\n","     ",RowBox[
{"If","[",RowBox[{"pairFound",","," ",RowBox[{"Break","[","]"}]}],"]"}],";"}]," ","\n","  ",","," ",RowBox[
{"{",RowBox[{"i",","," ","1",","," ",RowBox[{"nActive"," ","-"," ","1"}]}],"}"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"If","[",RowBox[{RowBox[{"Not","[","pairFound","]"}],","," ",RowBox[{"Return","[","g","]"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"(*"," ","\:786e\:5b9a\:5750\:6807"," ","*)"}],"\n","  ",RowBox[{"y"," ","="," ",RowBox[
{RowBox[{"Intersection","[",RowBox[{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[
{"List"," ","@@"," ","e2"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[
{"x"," ","="," ",RowBox[{RowBox[{"Complement","[",RowBox[{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[
{"{","y","}"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[{"z"," ","="," ",RowBox[
{RowBox[{"Complement","[",RowBox[{RowBox[{"List"," ","@@"," ","e2"}],","," ",RowBox[
{"{","y","}"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[{"w"," ","="," ",RowBox[
{RowBox[{"Max","[",RowBox[{"VertexList","[","g","]"}],"]"}]," ","+"," ","1"}]}],";","\n","  ","\n","  ",RowBox[
{"(*"," ","\:751f\:6210\:65b0\:8fb9"," ","*)"}],"\n","  ",RowBox[{"newActive"," ","="," ",RowBox[
{"{",RowBox[{RowBox[{"UndirectedEdge","[",RowBox[{"x",","," ","z"}],"]"}],","," ",RowBox[
{"UndirectedEdge","[",RowBox[{"x",","," ","w"}],"]"}],","," ",RowBox[{"UndirectedEdge","[",RowBox[
{"w",","," ","z"}],"]"}]}],"}"}]}],";","\n","  ",RowBox[{"inertEdges"," ","="," ",RowBox[
{"{",RowBox[{RowBox[{"DirectedEdge","[",RowBox[{"x",","," ","y"}],"]"}],","," ",RowBox[
{"DirectedEdge","[",RowBox[{"y",","," ","z"}],"]"}]}],"}"}]}],";","\n","  ",RowBox[
{"remainingEdges"," ","="," ",RowBox[{"Complement","[",RowBox[{"allEdges",","," ",RowBox[
{"{",RowBox[{"e1",","," ","e2"}],"}"}]}],"]"}]}],";","\n","  ","\n","  ",RowBox[{"(*"," ",RowBox[
{"\:6784\:9020\:65b0\:56fe"," ",RowBox[{"(",RowBox[{"\:4f7f\:7528"," ","Union"," ","\:53bb\:91cd"}],")"}]}]," ","*)"}],"\n","  ",RowBox[
{"Graph","[","\n","     ",RowBox[{RowBox[{"Join","[",RowBox[{RowBox[{"VertexList","[","g","]"}],","," ",RowBox[
{"{","w","}"}]}],"]"}],",","\n","     ",RowBox[{"Union","[",RowBox[{"remainingEdges",","," ","newActive",","," ","inertEdges"}],"]"}],",","\n","     ",RowBox[
{"GraphLayout"," ","\[Rule]"," ","\"SpringElectricalEmbedding\""}]}],"\n","  ","]"}]}]}],"\n","]"}]}],";"}]}]],RowBox[
{"\n","\n"}],StyleBox[RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{RowBox[{"--",RowBox[
{"-"," ","2."}]}]," ","\:5b9a\:4e49\:5e26\:63a2\:9488\:7684\:6f14\:5316\:51fd\:6570"," ",RowBox[
{RowBox[{"(","Probe",")"}]," ","--"}]}],"-"}]," ","*)"}],"\n",RowBox[{RowBox[{RowBox[
{"StepEvolutionWithProbe","[","g_Graph","]"}]," ",":="," ",RowBox[{"Module","[",RowBox[
{RowBox[{"{","\n","   ",RowBox[{"allEdges",","," ","activeEdges",","," ","shuffled",","," ","pairFound",","," ","\n","   ","e1",","," ","e2",","," ","x",","," ","y",","," ","z",","," ","w",","," ","\n","   ","k",","," ","accepted",","," ","\n","   ","newActive",","," ","inertEdges",","," ","remainingEdges",","," ","finalEdges",",","\n","   ","oldEdgeCount",","," ","newEdgeCount"}],"\n","  ","}"}],",","\n","  ","\n","  ",RowBox[
{RowBox[{"allEdges"," ","="," ",RowBox[{"EdgeList","[","g","]"}]}],";","\n","  ",RowBox[
{"activeEdges"," ","="," ",RowBox[{"Cases","[",RowBox[{"allEdges",","," ","_UndirectedEdge"}],"]"}]}],";","\n","  ","\n","  ",RowBox[
{"(*"," ","\:72b6\:6001\:68c0\:67e5"," ","*)"}],"\n","  ",RowBox[{"If","[",RowBox[
{RowBox[{RowBox[{"Length","[","activeEdges","]"}]," ","<"," ","2"}],","," ",RowBox[
{"Return","[",RowBox[{"{",RowBox[{"g",","," ",RowBox[{"-","1"}],","," ","False"}],"}"}],"]"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"shuffled"," ","="," ",RowBox[{"RandomSample","[","activeEdges","]"}]}],";","\n","  ",RowBox[
{"pairFound"," ","="," ","False"}],";","\n","  ","\n","  ",RowBox[{"Do","[","\n","     ",RowBox[
{RowBox[{RowBox[{"e1"," ","="," ",RowBox[{"shuffled","[",RowBox[{"[","i","]"}],"]"}]}],";","\n","     ",RowBox[
{"Do","[","\n","        ",RowBox[{RowBox[{RowBox[{"e2"," ","="," ",RowBox[{"shuffled","[",RowBox[
{"[","j","]"}],"]"}]}],";","\n","        ",RowBox[{"If","[",RowBox[{RowBox[{RowBox[
{"Length","[",RowBox[{"Intersection","[",RowBox[{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[
{"List"," ","@@"," ","e2"}]}],"]"}],"]"}]," ","=="," ","1"}],",","\n","           ",RowBox[
{RowBox[{"pairFound"," ","="," ","True"}],";","\n","           ",RowBox[{"Break","[","]"}],";"}]}],"\n","        ","]"}],";"}],"\n","     ",","," ",RowBox[
{"{",RowBox[{"j",","," ",RowBox[{"i"," ","+"," ","1"}],","," ",RowBox[{"Length","[","shuffled","]"}]}],"}"}]}],"]"}],";","\n","     ",RowBox[
{"If","[",RowBox[{"pairFound",","," ",RowBox[{"Break","[","]"}]}],"]"}],";"}],"\n","  ",","," ",RowBox[
{"{",RowBox[{"i",","," ","1",","," ",RowBox[{RowBox[{"Length","[","shuffled","]"}]," ","-"," ","1"}]}],"}"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"If","[",RowBox[{RowBox[{"Not","[","pairFound","]"}],","," ",RowBox[{"Return","[",RowBox[
{"{",RowBox[{"g",","," ",RowBox[{"-","1"}],","," ","False"}],"}"}],"]"}]}],"]"}],";","\n","  ","\n","  ",RowBox[
{"(*"," ","\:5750\:6807\:4e0e\:7edf\:8ba1"," ","*)"}],"\n","  ",RowBox[{"y"," ","="," ",RowBox[
{RowBox[{"Intersection","[",RowBox[{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[
{"List"," ","@@"," ","e2"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[
{"x"," ","="," ",RowBox[{RowBox[{"Complement","[",RowBox[{RowBox[{"List"," ","@@"," ","e1"}],","," ",RowBox[
{"{","y","}"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[{"z"," ","="," ",RowBox[
{RowBox[{"Complement","[",RowBox[{RowBox[{"List"," ","@@"," ","e2"}],","," ",RowBox[
{"{","y","}"}]}],"]"}],"[",RowBox[{"[","1","]"}],"]"}]}],";","\n","  ",RowBox[{"w"," ","="," ",RowBox[
{RowBox[{"Max","[",RowBox[{"VertexList","[","g","]"}],"]"}]," ","+"," ","1"}]}],";","\n","  ","\n","  ",RowBox[
{"(*"," ",RowBox[{"\:63a2\:9488","\:ff1a",RowBox[{RowBox[{"\:7edf\:8ba1\:53cd\:5e94\:524d"," ","x"}],"-",RowBox[
{"z"," ","\:4e4b\:95f4\:7684\:8fb9\:6570"," ",RowBox[{"(","\:65e0\:8bba\:6b7b\:6d3b",")"}]}]}]}]," ","*)"}],"\n","  ",RowBox[
{"k"," ","="," ",RowBox[{"Length","[",RowBox[{"Select","[",RowBox[{"allEdges",","," ",RowBox[
{RowBox[{RowBox[{"Sort","[",RowBox[{"List"," ","@@"," ","#"}],"]"}]," ","==="," ",RowBox[
{"Sort","[",RowBox[{"{",RowBox[{"x",","," ","z"}],"}"}],"]"}]}]," ","&"}]}],"]"}],"]"}]}],";","\n","  ","\n","  ",RowBox[
{"newActive"," ","="," ",RowBox[{"{",RowBox[{RowBox[{"UndirectedEdge","[",RowBox[
{"x",","," ","z"}],"]"}],","," ",RowBox[{"UndirectedEdge","[",RowBox[{"x",","," ","w"}],"]"}],","," ",RowBox[
{"UndirectedEdge","[",RowBox[{"w",","," ","z"}],"]"}]}],"}"}]}],";","\n","  ",RowBox[
{"inertEdges"," ","="," ",RowBox[{"{",RowBox[{RowBox[{"DirectedEdge","[",RowBox[{"x",","," ","y"}],"]"}],","," ",RowBox[
{"DirectedEdge","[",RowBox[{"y",","," ","z"}],"]"}]}],"}"}]}],";","\n","  ",RowBox[
{"remainingEdges"," ","="," ",RowBox[{"Complement","[",RowBox[{"allEdges",","," ",RowBox[
{"{",RowBox[{"e1",","," ","e2"}],"}"}]}],"]"}]}],";","\n","  ","\n","  ",RowBox[{"(*"," ",RowBox[
{"\:6267\:884c"," ","Union"}]," ","*)"}],"\n","  ",RowBox[{"finalEdges"," ","="," ",RowBox[
{"Union","[",RowBox[{"remainingEdges",","," ","newActive",","," ","inertEdges"}],"]"}]}],";","\n","  ","\n","  ",RowBox[
{"(*"," ",RowBox[{"\:5224\:5b9a"," ",RowBox[{"accepted",":"," ","\:770b\:603b\:8fb9\:6570\:53d8\:5316\:91cf"}]}]," ","*)"}],"\n","  ",RowBox[
{"(*"," ",RowBox[{"\:7406\:8bba","\:ff1a",RowBox[{RowBox[{RowBox[{RowBox[{"-","2"}],RowBox[
{"(","\:6d88\:8017",")"}]}]," ","+"," ",RowBox[{"2",RowBox[{"(","\:51bb\:7ed3",")"}]}]," ","+"," ",RowBox[
{"2",RowBox[{"(",RowBox[{"\:5fc5\:6210\:65b0\:8fb9xw","/","wz"}],")"}]}]," ","+"," ",RowBox[
{"1",RowBox[{"(","\:53ef\:80fd\:6210\:7684xz",")"}]}]}]," ","="," ",RowBox[{"+","3"}]}]}]," ","*)"}],"\n","  ",RowBox[
{"(*"," ",RowBox[{"\:5b9e\:9645","\:ff1a",RowBox[{RowBox[{"\:5982\:679c"," ","diff"}]," ","=="," ",RowBox[
{"3"," ","\:5219"," ","xz"," ","\:6210\:529f"}]}],"\:ff1b",RowBox[{RowBox[{"\:5982\:679c"," ","diff"}]," ","=="," ",RowBox[
{"2"," ","\:5219"," ","xz"," ","\:88ab\:541e"}]}]}]," ","*)"}],"\n","  ",RowBox[{"diff"," ","="," ",RowBox[
{RowBox[{"Length","[","finalEdges","]"}]," ","-"," ",RowBox[{"Length","[","allEdges","]"}]}]}],";","\n","  ",RowBox[
{"accepted"," ","="," ",RowBox[{"(",RowBox[{"diff"," ","=="," ","3"}],")"}]}],";","\n","  ","\n","  ",RowBox[
{"{",RowBox[{RowBox[{"Graph","[",RowBox[{RowBox[{"Join","[",RowBox[{RowBox[{"VertexList","[","g","]"}],","," ",RowBox[
{"{","w","}"}]}],"]"}],","," ","finalEdges"}],"]"}],","," ","k",","," ","accepted"}],"}"}]}]}],"\n","]"}]}],";"}]}]],RowBox[
{"\n","\n"}],StyleBox[RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{RowBox[{"--",RowBox[
{"-"," ","3."}]}]," ",RowBox[{"\:8fd0\:884c\:4e3b\:7a0b\:5e8f"," ","--"}]}],"-"}]," ","*)"}],"\n","\n",RowBox[
{"(*"," ",RowBox[{"\:521d\:59cb\:5316\:7edf\:8ba1\:6570\:636e"," ",RowBox[{"(",RowBox[
{"\:4f7f\:7528\:666e\:901a\:5217\:8868","\:ff0c","\:517c\:5bb9\:65e7\:7248"}],")"}]}]," ","*)"}],"\n",RowBox[
{"(*"," ",RowBox[{"stats"," ",RowBox[{"\:7ed3\:6784",":"," ",RowBox[{"{",RowBox[{RowBox[
{"k","=",RowBox[{"0","\:7684\:6b21\:6570"}]}],","," ",RowBox[{"k","=",RowBox[{"0","\:6210\:529f\:6570"}]}],","," ",RowBox[
{"k","=",RowBox[{"1","\:6b21\:6570"}]}],","," ",RowBox[{"k","=",RowBox[{"1","\:6210\:529f\:6570"}]}],","," ",RowBox[
{"k","=",RowBox[{"2","\:6b21\:6570"}]}],","," ",RowBox[{"k","=",RowBox[{"2","\:6210\:529f\:6570"}]}]}],"}"}]}]}]," ","*)"}],"\n",RowBox[
{RowBox[{"statsAttempts"," ","="," ",RowBox[{"<|"," ",RowBox[{RowBox[{"0"," ","\[Rule]"," ","0"}],","," ",RowBox[
{"1"," ","\[Rule]"," ","0"}],","," ",RowBox[{"2"," ","\[Rule]"," ","0"}],","," ",RowBox[
{"3"," ","\[Rule]"," ","0"}]}]," ","|>"}]}],";"}]}]],"\n",RowBox[{RowBox[{"statsSuccess"," ","="," ",RowBox[
{"<|"," ",RowBox[{RowBox[{"0"," ","\[Rule]"," ","0"}],","," ",RowBox[{"1"," ","\[Rule]"," ","0"}],","," ",RowBox[
{"2"," ","\[Rule]"," ","0"}],","," ",RowBox[{"3"," ","\[Rule]"," ","0"}]}]," ","|>"}]}],";"}],RowBox[
{"\n","\n"}],StyleBox[RowBox[{RowBox[{"(*"," ","\:521d\:59cb\:5316\:5b87\:5b99"," ","*)"}],"\n",RowBox[
{RowBox[{"universe"," ","="," ",RowBox[{"Graph","[",RowBox[{RowBox[{"{",RowBox[{"1",","," ","2",","," ","3"}],"}"}],","," ",RowBox[
{"{",RowBox[{RowBox[{"UndirectedEdge","[",RowBox[{"1",","," ","2"}],"]"}],","," ",RowBox[
{"UndirectedEdge","[",RowBox[{"2",","," ","3"}],"]"}],","," ",RowBox[{"UndirectedEdge","[",RowBox[
{"3",","," ","1"}],"]"}]}],"}"}]}],"]"}]}],";"}]}]],RowBox[{"\n","\n"}],StyleBox[
RowBox[{RowBox[{"(*"," ",RowBox[{"\:9884\:70ed","\:ff1a",RowBox[{"\:5148\:8dd1"," ","500"," ","\:6b65\:8ba9\:5b87\:5b99\:957f\:8d77\:6765"}]}]," ","*)"}],"\n",RowBox[
{RowBox[{"Print","[","\"start (500 steps)...\"","]"}],";"}]}]],"\n",RowBox[{RowBox[
{"Do","[",RowBox[{RowBox[{"universe"," ","="," ",RowBox[{"StepEvolution","[","universe","]"}]}],","," ",RowBox[
{"{","500","}"}]}],"]"}],";"}],"\n",RowBox[{RowBox[{"Print","[",RowBox[{"\"finished: \"",","," ",RowBox[
{"VertexCount","[","universe","]"}]}],"]"}],";"}],RowBox[{"\n","\n"}],StyleBox[RowBox[
{RowBox[{"(*"," ","\:5f00\:59cb\:9a8c\:8bc1"," ","*)"}],"\n",RowBox[{RowBox[{"validationSteps"," ","="," ","3000"}],";"}]}]],"\n",RowBox[
{RowBox[{"Print","[",RowBox[{"Style","[",RowBox[{"\"Ver_begining (2000 steps)...\"",","," ","Blue",","," ","Bold"}],"]"}],"]"}],";"}],RowBox[
{"\n","\n"}],RowBox[{RowBox[{"Monitor","[","\n","  ",RowBox[{RowBox[{"Do","[","\n","     ",RowBox[
{RowBox[{RowBox[{"result"," ","="," ",RowBox[{"StepEvolutionWithProbe","[","universe","]"}]}],";","\n","     ","\n","     ",RowBox[
{"(*"," ","\:89e3\:5305\:7ed3\:679c"," ","*)"}],"\n","     ",RowBox[{"newG"," ","="," ",RowBox[
{"result","[",RowBox[{"[","1","]"}],"]"}]}],";","\n","     ",RowBox[{"kVal"," ","="," ",RowBox[
{"result","[",RowBox[{"[","2","]"}],"]"}]}],";","\n","     ",RowBox[{"isAccepted"," ","="," ",RowBox[
{"result","[",RowBox[{"[","3","]"}],"]"}]}],";","\n","     ","\n","     ",RowBox[
{"(*"," ","\:8bb0\:5f55\:6709\:6548\:6570\:636e"," ","*)"}],"\n","     ",RowBox[{"If","[",RowBox[
{RowBox[{"kVal"," ","\[NotEqual]"," ",RowBox[{"-","1"}]}],",","\n","        ",RowBox[
{RowBox[{"If","[",RowBox[{RowBox[{"KeyExistsQ","[",RowBox[{"statsAttempts",","," ","kVal"}],"]"}],",","\n","           ",RowBox[
{RowBox[{RowBox[{"statsAttempts","[","kVal","]"}]," ","="," ",RowBox[{RowBox[{"statsAttempts","[","kVal","]"}]," ","+"," ","1"}]}],";","\n","           ",RowBox[
{"If","[",RowBox[{"isAccepted",","," ",RowBox[{RowBox[{"statsSuccess","[","kVal","]"}]," ","="," ",RowBox[
{RowBox[{"statsSuccess","[","kVal","]"}]," ","+"," ","1"}]}]}],"]"}],";"}]}],"\n","        ","]"}],";","\n","        ",RowBox[
{"universe"," ","="," ","newG"}],";"}]}],"\n","     ","]"}],";"}],"\n","     ","\n","  ",","," ",RowBox[
{"{",RowBox[{"step",","," ","1",","," ","validationSteps"}],"}"}]}],"]"}],",","\n","  ","\n","  ",RowBox[
{"Row","[",RowBox[{"{",RowBox[{RowBox[{"ProgressIndicator","[",RowBox[{"step",","," ",RowBox[
{"{",RowBox[{"0",","," ","validationSteps"}],"}"}]}],"]"}],","," ","\" steps: \"",","," ","step",","," ","\" | current k=\"",","," ","kVal"}],"}"}],"]"}]}],"\n","]"}],";"}],RowBox[
{"\n","\n"}],StyleBox[RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{RowBox[{"--",RowBox[
{"-"," ","4."}]}]," ",RowBox[{"\:7ed8\:56fe\:4e0e\:62a5\:544a"," ","--"}]}],"-"}]," ","*)"}],"\n",RowBox[
{RowBox[{"Print","[","\"\\n=== Result/report ===\"","]"}],";"}]}]],"\n",RowBox[{RowBox[
{"probs"," ","="," ",RowBox[{"{","}"}]}],";"}],"\n",RowBox[{RowBox[{"labels"," ","="," ",RowBox[
{"{","}"}]}],";"}],"\n",RowBox[{RowBox[{"kValues"," ","="," ",RowBox[{"{",RowBox[
{"0",","," ","1",","," ","2"}],"}"}]}],";"}],RowBox[{"\n","\n"}],RowBox[{RowBox[{"Do","[","\n","   ",RowBox[
{RowBox[{RowBox[{"att"," ","="," ",RowBox[{"statsAttempts","[","k","]"}]}],";","\n","   ",RowBox[
{"succ"," ","="," ",RowBox[{"statsSuccess","[","k","]"}]}],";","\n","   ",RowBox[
{"prob"," ","="," ",RowBox[{"If","[",RowBox[{RowBox[{"att"," ",">"," ","0"}],","," ",RowBox[
{"succ","/","att"}],","," ","0.0"}],"]"}]}],";","\n","   ",RowBox[{"AppendTo","[",RowBox[
{"probs",","," ","prob"}],"]"}],";","\n","   ",RowBox[{"label"," ","="," ",RowBox[
{RowBox[{"ToString","[","succ","]"}]," ","<>"," ","\"/\""," ","<>"," ",RowBox[{"ToString","[","att","]"}]}]}],";","\n","   ","\n","   ",RowBox[
{"Print","[",RowBox[{"\"k=\"",","," ","k",","," ","\" | attampt: \"",","," ","att",","," ","\" | success: \"",","," ","succ",","," ","\" | P: \"",","," ",RowBox[
{"NumberForm","[",RowBox[{RowBox[{"prob","*","100"}],","," ",RowBox[{"{",RowBox[{"4",","," ","2"}],"}"}]}],"]"}],","," ","\"%\""}],"]"}],";"}],"\n",","," ",RowBox[
{"{",RowBox[{"k",","," ","0",","," ","2"}],"}"}]}],"]"}],";"}],RowBox[{"\n","\n"}],RowBox[
{"BarChart","[",RowBox[{"probs",","," ","\n","  ",RowBox[{"ChartLabels"," ","\[Rule]"," ",RowBox[
{"Placed","[",RowBox[{"kValues",","," ","Below"}],"]"}]}],","," ","\n","  ",RowBox[
{"LabelingFunction"," ","\[Rule]"," ",RowBox[{"(",RowBox[{RowBox[{"Placed","[",RowBox[
{RowBox[{"Row","[",RowBox[{"{",RowBox[{RowBox[{"NumberForm","[",RowBox[{RowBox[{"#","*","100"}],","," ",RowBox[
{"{",RowBox[{"3",","," ","1"}],"}"}]}],"]"}],","," ","\"%\""}],"}"}],"]"}],","," ","Above"}],"]"}]," ","&"}],")"}]}],",","\n","  ",RowBox[
{"ChartStyle"," ","\[Rule]"," ",RowBox[{"{",RowBox[{"Green",","," ","Orange",","," ","Red"}],"}"}]}],",","\n","  ",RowBox[
{"PlotLabel"," ","\[Rule]"," ","\"Acceptance Probability vs. Link Density (Fermi Check)\""}],",","\n","  ",RowBox[
{"AxesLabel"," ","\[Rule]"," ",RowBox[{"{",RowBox[{"\"Existing Links (k)\"",","," ","\"Probability P(Add)\""}],"}"}]}],",","\n","  ",RowBox[
{"PlotRange"," ","\[Rule]"," ",RowBox[{"{",RowBox[{"0",","," ","1.1"}],"}"}]}],",","\n","  ",RowBox[
{"ImageSize"," ","\[Rule]"," ","400"}]}],"\n","]"}]}],"Input",CellLabel -> "In[104]:= ",
ExpressionUUID -> "e3906158-06b1-413d-9559-da98e95decba"],Cell[
BoxData["\"start (500 steps)...\"",
StandardForm],"Print",ExpressionUUID -> "88899036-151c-437f-b21c-4a3069efa685"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"finished: \"","\[InvisibleSpace]","503"}],SequenceForm[
"finished: ",503],Editable -> False],StandardForm],"Print",ExpressionUUID -> "8c4890d4-78e0-4397-9a83-19560823c55f"],Cell[
BoxData[
StyleBox["\"Ver_begining (2000 steps)...\"",RGBColor[0,0,1],Bold,StripOnInput -> False],
StandardForm],"Print",ExpressionUUID -> "049c0cfc-90b6-4acd-af99-a45895666200"]},
Open],ExpressionUUID -> "5f6b38bd-a339-429e-ad65-6702279be4da"],Cell[
BoxData[TemplateBox[
{"Cloud","timelimit","\"This computation has exceeded the time limit for your plan.\"",2,116,13,27823204982787229646,"Local","CloudSystem`Cloud"},
"MessageTemplate2",BaseStyle -> "MSG"],StandardForm],"MSG","Message",ExpressionUUID -> "dba03bf8-57cb-48b8-8c25-d987e2b6182f"],Cell[
BoxData[
"$Aborted",StandardForm],"Output",CellLabel -> "Out[116]= ",ExpressionUUID -> "0bfb81bc-006f-4c3a-ada6-5c10582d39a5"],Cell[
BoxData[
"\"\\n=== Result/report ===\"",StandardForm],"Print",ExpressionUUID -> "9d778970-b84d-4d5d-99a7-3061842478cb"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"k=\"","\[InvisibleSpace]","0","\[InvisibleSpace]","\" | attampt: \"","\[InvisibleSpace]","1061","\[InvisibleSpace]","\" | success: \"","\[InvisibleSpace]","893","\[InvisibleSpace]","\" | P: \"","\[InvisibleSpace]",TagBox[
FractionBox[InterpretationBox[StyleBox["\"89300\"",ShowStringCharacters -> False],
89300,Editable -> False],InterpretationBox[StyleBox["\"1061\"",ShowStringCharacters -> False],
1061,Editable -> False]],Function[NumberForm[Slot[1],{4,2}]]],"\[InvisibleSpace]","\"%\""}],
SequenceForm["k=",0," | attampt: ",1061," | success: ",893," | P: ",NumberForm[Rational[
89300,1061],{4,2}],"%"],Editable -> False],StandardForm],"Print",ExpressionUUID -> "9d72a640-e341-4264-94c5-dc1ff19f11ef"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"k=\"","\[InvisibleSpace]","1","\[InvisibleSpace]","\" | attampt: \"","\[InvisibleSpace]","1708","\[InvisibleSpace]","\" | success: \"","\[InvisibleSpace]","916","\[InvisibleSpace]","\" | P: \"","\[InvisibleSpace]",TagBox[
FractionBox[InterpretationBox[StyleBox["\"22900\"",ShowStringCharacters -> False],
22900,Editable -> False],InterpretationBox[StyleBox["\"427\"",ShowStringCharacters -> False],
427,Editable -> False]],Function[NumberForm[Slot[1],{4,2}]]],"\[InvisibleSpace]","\"%\""}],
SequenceForm["k=",1," | attampt: ",1708," | success: ",916," | P: ",NumberForm[Rational[
22900,427],{4,2}],"%"],Editable -> False],StandardForm],"Print",ExpressionUUID -> "ddb881c6-4add-4eba-b0e3-4bafe75c3239"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"k=\"","\[InvisibleSpace]","2","\[InvisibleSpace]","\" | attampt: \"","\[InvisibleSpace]","167","\[InvisibleSpace]","\" | success: \"","\[InvisibleSpace]","62","\[InvisibleSpace]","\" | P: \"","\[InvisibleSpace]",TagBox[
FractionBox[InterpretationBox[StyleBox["\"6200\"",ShowStringCharacters -> False],
6200,Editable -> False],InterpretationBox[StyleBox["\"167\"",ShowStringCharacters -> False],
167,Editable -> False]],Function[NumberForm[Slot[1],{4,2}]]],"\[InvisibleSpace]","\"%\""}],
SequenceForm["k=",2," | attampt: ",167," | success: ",62," | P: ",NumberForm[Rational[
6200,167],{4,2}],"%"],Editable -> False],StandardForm],"Print",ExpressionUUID -> "9b9904f8-64e8-49d2-8ffe-811f8199c860"],Cell[
BoxData[
GraphicsBox[{{Opacity[0],PointBox[{{-0.4116533139111435`,0.`},{4.35360524399126`,0.`}}]},{{},{Directive[
RGBColor[1.`,0.78`,0.2`],EdgeForm[Directive[Thickness[Small],Opacity[0.6789999999999999`],
GrayLevel[0]]]],{{Directive[EdgeForm[Directive[Thickness[Small],Opacity[0.6789999999999999`],
GrayLevel[0]]],RGBColor[0,1,0]],TagBox[DynamicBox[{FEPrivate`If[CurrentValue["MouseOver"],
EdgeForm[{GrayLevel[0.5`],AbsoluteThickness[1.5`],Opacity[0.66`]}],{},{}],RectangleBox[
{0.5487982520029133`,0.`},{1.4512017479970867`,0.8416588124410933`},"RoundingRadius" -> 0]}],
"DelayedMouseEffectStyle"]},{Directive[EdgeForm[Directive[Thickness[Small],Opacity[
0.6789999999999999`],GrayLevel[0]]],RGBColor[1,0.5`,0]],TagBox[DynamicBox[{FEPrivate`If[
CurrentValue["MouseOver"],EdgeForm[{GrayLevel[0.5`],AbsoluteThickness[1.5`],Opacity[
0.66`]}],{},{}],RectangleBox[{1.5487982520029133`,0.`},{2.4512017479970867`,0.5362997658079626`},
"RoundingRadius" -> 0]}],"DelayedMouseEffectStyle"]},{Directive[EdgeForm[Directive[
Thickness[Small],Opacity[0.6789999999999999`],GrayLevel[0]]],RGBColor[1,0,0]],TagBox[
DynamicBox[{FEPrivate`If[CurrentValue["MouseOver"],EdgeForm[{GrayLevel[0.5`],AbsoluteThickness[
1.5`],Opacity[0.66`]}],{},{}],RectangleBox[{2.5487982520029133`,0.`},{3.4512017479970867`,0.3712574850299401`},
"RoundingRadius" -> 0]}],"DelayedMouseEffectStyle"]}}},{},{}},{},{InsetBox[FormBox[
StyleBox["0",{},StripOnInput -> False],TraditionalForm],Offset[{0,-4},{1.`,0.`}],
ImageScaled[{0.5`,1}]],InsetBox[FormBox[StyleBox[TemplateBox[{TagBox[FractionBox[
InterpretationBox[StyleBox["\"89300\"",ShowStringCharacters -> False],89300,Editable -> False],
InterpretationBox[StyleBox["\"1061\"",ShowStringCharacters -> False],1061,Editable -> False]],
Function[NumberForm[Slot[1],{3,1}]]],"\"%\""},"RowDefault"],{},StripOnInput -> False],
TraditionalForm],Offset[{0,4},{1.`,0.8416588124410933`}],ImageScaled[{0.5`,0}]],InsetBox[
FormBox[StyleBox["1",{},StripOnInput -> False],TraditionalForm],Offset[{0,-4},{2.`,0.`}],
ImageScaled[{0.5`,1}]],InsetBox[FormBox[StyleBox[TemplateBox[{TagBox[FractionBox[
InterpretationBox[StyleBox["\"22900\"",ShowStringCharacters -> False],22900,Editable -> False],
InterpretationBox[StyleBox["\"427\"",ShowStringCharacters -> False],427,Editable -> False]],
Function[NumberForm[Slot[1],{3,1}]]],"\"%\""},"RowDefault"],{},StripOnInput -> False],
TraditionalForm],Offset[{0,4},{2.`,0.5362997658079626`}],ImageScaled[{0.5`,0}]],InsetBox[
FormBox[StyleBox["2",{},StripOnInput -> False],TraditionalForm],Offset[{0,-4},{3.`,0.`}],
ImageScaled[{0.5`,1}]],InsetBox[FormBox[StyleBox[TemplateBox[{TagBox[FractionBox[
InterpretationBox[StyleBox["\"6200\"",ShowStringCharacters -> False],6200,Editable -> False],
InterpretationBox[StyleBox["\"167\"",ShowStringCharacters -> False],167,Editable -> False]],
Function[NumberForm[Slot[1],{3,1}]]],"\"%\""},"RowDefault"],{},StripOnInput -> False],
TraditionalForm],Offset[{0,4},{3.`,0.3712574850299401`}],ImageScaled[{0.5`,0}]]},{},{},{StyleBox[
{Antialiasing -> False,{Directive[Thickness[Tiny]],{LineBox[{{-0.4116533139111435`,0.`},{4.430862345229425`,0.`}}]},StyleBox[
{Directive[Thickness[Tiny]],StyleBox[{InsetBox[FormBox[TagBox["\"Existing Links (k)\"",
HoldForm],TraditionalForm],Offset[{10.`,0.`},{3.4512017479970862`,0.`}],NCache[ImageScaled[
{0,Rational[1,2]}],ImageScaled[{0,0.5`}]],Automatic,{1,0}]},{{}},StripOnInput -> False]},
{"GraphicsLabel"},StripOnInput -> False]},StyleBox[{{Directive[Thickness[Tiny]],LineBox[
{{0.5487982520029133`,0.`},Offset[{-1.102182119232618`*^-15,-6.`},{0.5487982520029133`,0.`}]}],LineBox[
{{3.4512017479970867`,0.`},Offset[{-1.102182119232618`*^-15,-6.`},{3.4512017479970867`,0.`}]}],{{},{},{},{},{}}},StyleBox[
{},{"GraphicsLabel"},StripOnInput -> False]},{"GraphicsTicks"},StripOnInput -> False]},
{"GraphicsAxes"},StripOnInput -> False]}},{DisplayFunction -> Identity,RuleDelayed[
PlotInteractivity,True],DefaultBaseStyle -> {"PlotGraphics","Graphics"},AspectRatio -> NCache[
Power[GoldenRatio,-1],0.6180339887498948`],Axes -> {False,True},AxesLabel -> {FormBox[
TagBox["\"Existing Links (k)\"",HoldForm],TraditionalForm],FormBox[TagBox["\"Probability P(Add)\"",
HoldForm],TraditionalForm]},AxesOrigin -> {-0.4116533139111435`,0.`},CoordinatesToolOptions -> CompressedData[
"1:eJxTTMoPSmNiYGAoZgESPpnFJQheUGlOajA/kOGSWVyQk1jpVpqXXJKZn5fGCFLBASTgIqgmwOU9U1LzSjJLKhHyAYlFUHkQLzgnvyQTxAMT5OgDKUBzsTCQ4ZxfkJmaEpaYU5o6WF0NAFk5TEk="],FrameLabel -> {{None,None},{None,None}},FrameTicks -> {{Automatic,Automatic},{Automatic,Automatic}},GridLines -> {None,None},GridLinesStyle -> Directive[
GrayLevel[0.5`,0.4`]],ImageSize -> 400,PlotLabel -> FormBox["\"Acceptance Probability vs. Link Density (Fermi Check)\"",
TraditionalForm],PlotRange -> {{All,All},{0,1.1`}},PlotRangePadding -> {{Scaled[0.02`],Scaled[
0.02`]},{0,0}},Ticks -> {None,Automatic}},ExpressionUUID -> "71880465-ef5a-4f6d-8c5d-a2f6eae4c3c3"],
StandardForm],"Output",CellLabel -> "Out[122]= ",ExpressionUUID -> "b13822d2-103e-46df-8af1-bd877b626df3"]},
StyleDefinitions -> "Default.nb",FrontEndVersion -> "14.3 for Wolfram Cloud 1.75 (December 9, 2025)"]